<ion-header>
  <ion-navbar>
  </ion-navbar>
</ion-header>

<ion-content class="padding-sign">
  <div (tap)="toggleMode()" class="logo">
  </div>
  <div text-center class="title-big-sign">{{ 'PAGE_LOGIN.LOGIN' | translate }}</div>
  <div text-center class="margin-top-6vw font-75 text-4F4F4F">
    {{ 'PAGE_LOGIN.PLEASE_ENTER' | translate }}<br>{{ 'PAGE_LOGIN.CONFIRMATION_CODE' | translate }}
  </div>

  <form 
    #form="ngForm" 
    (ngSubmit)="(form.valid && isVisibleLoginButton) ? login() : (form.valid && !isVisibleLoginButton) ? getOtp() : undefined">
  <div *ngIf="!isVisibleLoginButton" class="bg-gray margin-top-6vw">
  <ion-item class="border-bottom-no">
    <ion-select
      #codeSelect
      [(ngModel)]="numCode"
      [ngModelOptions]="{standalone: true}"
      interface="alert"
      [selectOptions]="{cssClass: 'alert-full-no-button'}"
      [selectedText]="numCode"
      (click)="onSelectClicked(codeSelect)">
      <ion-option  
        *ngFor=" let phoneCode of phoneCodes " 
        [value]="phoneCode.dial_code"
        (ionSelect)="dismissSelect($event)">
        {{ phoneCode.dial_code }} {{ phoneCode.name }}
      </ion-option>
    </ion-select>
    <ion-input
      (ionChange)="limitStr(authData.phone, 14)"
      (keyup)="updateList($event)"
      [(ngModel)]="authData.phone"
      required
      ngControl="phone"
      name="phone"
      [minlength]="7"
      class="tel"
      type="number"
      placeholder="1234567"></ion-input>
  </ion-item>
  </div>

  <div *ngIf="isVisibleLoginButton" class="bg-gray margin-top-6vw padding-left-6a3vw">
      <ion-item class="border-bottom-no">
        <ion-label>{{ 'PAGE_LOGIN.OTP' | translate }}</ion-label>
        <ion-input
          (ionChange)="limitStr(authData.code, 6)"
          (keyup)="updateList($event)"
          [(ngModel)]="authData.code"
          required
          ngControl="code"
          name="code"
          [minlength]="6"
          class="otp"
          type="number"
          placeholder="XXXXXX">
        </ion-input>
      </ion-item>
  </div>
</form>

<button
  *ngIf="isVisibleLoginButton"
  (click)="login()"
  [disabled]="!form.valid"
  type="submit"
  text-uppercase
  class="margin-top-5vw"
  ion-button block
  middle
  color="primary" >
  {{ 'UNIT.SIGN_IN' | translate }}
</button>

<button
  *ngIf="!isVisibleLoginButton"
  (click)="getOtp()"
  [disabled]="!form.valid"
  type="submit"
  text-uppercase
  class="margin-top-5vw"
  ion-button block
  middle
  color="primary" >
  {{ 'PAGE_LOGIN.GET_OTP' | translate }}
</button>

</ion-content>

<ion-footer no-shadow no-border>
  <div text-center>
    <div><a (click)="signup()" class="link-nau">{{ 'UNIT.SIGN_UP' | translate }}</a></div>
  </div>
  <div *ngIf="envName === 'dev'" class="devmode">Dev mode</div>
  <div *ngIf="envName === 'test'" class="devmode">Test mode</div>
</ion-footer>
